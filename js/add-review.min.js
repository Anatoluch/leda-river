$(document).ready(function(){function a(){return g=Math.round(10*Math.random()),h=Math.round(10*Math.random()),i=g+h,i}function b(){let a=document.querySelectorAll(".reviews-page__form label.error");a.forEach(function(a){a.style="display:none"})}function c(){$("#review-answer").html(`<div class='contact-form__success'>
			<h2>Ваш отзыв принят!<br>
			Он будет&nbsp;опубликован после&nbsp;прохождения модерации!
			</h2>
			</div>`)}window.FormData||alert(`Браузер не поддерживает загрузку файлов на этом сайте!\nВы не сможете прикрепить аватарку к отзыву!`),$(".review-avatar").change(function(){""==$(this).val()?($(this).closest(".file-row").children(".upload-label").text("\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0444\u0430\u0439\u043B"),$(".upload-label").blur(),$(".upload-label").removeClass("chosen")):($(this).closest(".file-row").children(".upload-label").text("\u0424\u0430\u0439\u043B \u0432\u044B\u0431\u0440\u0430\u043D!"),$(".upload-label").blur(),$(".upload-label").addClass("chosen"))});let d=480,e=document.querySelector("#counter"),f=document.querySelector(".counter");$("textarea").keyup(function(){this.value.length>d?(this.value=this.value.substr(0,d),f="color:red; font-weight:700; font-size:16px"):this.value.length<d&&420<this.value.length?f.style="color:orange; font-weight:500; font-size:16px":this.value.length==d?f.style="color:red; font-weight:700; font-size:16px":this.value.length<d&&f.removeAttribute("style")}),$("#counter").html(480),$("#review-Text").keyup(function(){var a=this.value.length;this.value.length>d&&(this.value=this.value.substr(0,d));var b=d-a;0>=b?$("#counter").html("0"):$("#counter").html(b)});let g,h,i,j=document.querySelector(".reviews-page__form"),k=document.querySelectorAll(".reviews-page__form .fake-placeholder"),l=document.querySelector(".review-form-checkbox"),m=document.querySelector("#avatar-preview"),n=document.querySelector("#review-bot-row"),o=document.querySelector("#review-question-1-row"),p=document.querySelector("#review-question-2-row"),q=document.querySelector("#submit-rev-btn"),r=document.querySelector("#reset-rev-btn"),s=document.querySelector("#review-bot-placeholder-1"),t=document.querySelector("#review-bot-placeholder-2"),u=document.querySelector("#review-question-inp-1"),v=document.querySelector("#review-question-inp-2"),w=document.querySelector("#review-bot-question-1"),z=document.querySelector("#review-bot-question-2");l.addEventListener("change",function(b){!0==b.target.checked?(a(),u.innerText=`${g} + ${h}?`,n.classList.remove("hidden"),o.classList.remove("hidden"),this.disabled=!0,w.addEventListener("input",function(a){let b=parseInt(a.target.value);return b===i?void(q.disabled=!0,o.classList.add("hidden"),p.classList.remove("hidden"),s.classList.remove("active-field"),w.blur(),z.focus(),l.disabled=!0):void(q.disabled=!0)})):(n.classList.add("hidden"),o.classList.add("hidden"),p.classList.add("hidden"))}),v.innerText=`России?`,z.addEventListener("input",function(a){let b=a.target.value.toLowerCase();"\u043C\u043E\u0441\u043A\u0432\u0430"===b?(q.disabled=!1,n.classList.add("hidden"),j.setAttribute("method","POST"),j.setAttribute("action","./php/reviews.php"),p.classList.add("hidden"),t.classList.remove("active-field"),z.blur()):q.disabled=!0}),w.addEventListener("input",function(){this.value=this.value.replace(/[^+0-9]/g,"")});z.addEventListener("input",function(){this.value=this.value.replace(/[^А-Яа-я-]/g,"")});let A=document.querySelector("#avatar-file");A.addEventListener("input",function(){let a=document.getElementById("avatar-file").files[0],b=new FileReader;return 1048576<a.size?(alert("\u0424\u0430\u0439\u043B \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u043E\u0439! \u0420\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u0435\u043D \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 1 \u041C\u0411!\n\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0432\u044B\u0431\u0440\u0430\u0442\u044C \u0434\u0440\u0443\u0433\u043E\u0439 \u0444\u0430\u0439\u043B."),void(A.value="")):"image/jpeg"!==a.type&&"image/png"!==a.type&&"image/gif"!==a.type?(alert("\u0414\u0430\u043D\u043D\u044B\u0439 \u0442\u0438\u043F \u0444\u0430\u0439\u043B\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043D\u0435\u043B\u044C\u0437\u044F!"),void(A.value="")):void(b.onload=function(a){m.innerHTML=`<img src="${a.target.result}" alt="Аватар">`},b.readAsDataURL(a),m.style="height:75px;opacity:1;")}),r.addEventListener("click",function(){l.disabled=!1,q.disabled=!1,k.forEach(function(a){a.classList.remove("active-field")}),n.classList.add("hidden"),o.classList.add("hidden"),p.classList.add("hidden"),f.removeAttribute("style"),e.innerText=d,A.value="",$(".upload-label").text("\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0444\u0430\u0439\u043B"),$(".upload-label").blur(),$(".upload-label").removeClass("chosen"),m.innerHTML="",m.removeAttribute("style"),j.removeAttribute("method","POST"),j.removeAttribute("action","./php/reviews.php"),this.blur(),b()}),$(".reviews-page__form").validate({rules:{reviewsUserName:{required:!0},reviewsEmail:{required:!0,email:!0},reviewText:{required:!0},reviewsCheckbox:{required:!0},botQuestion1:{required:!0,minlength:1,maxlength:2},botQuestion2:{required:!0,minlength:1,maxlength:6}},messages:{reviewsUserName:{required:"\u0410 \u043A\u0430\u043A \u043A \u0412\u0430\u043C \u043E\u0431\u0440\u0430\u0449\u0430\u0442\u044C\u0441\u044F?!"},reviewsEmail:{required:"\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0443\u043A\u0430\u0436\u0438\u0442\u0435 \u0412\u0430\u0448 email!",email:"\u0412\u0432\u0435\u0434\u0435\u043D \u043D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 \u0430\u0434\u0440\u0435\u0441 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B!"},review:{required:"\u0410 \u0433\u0434\u0435, \u0441\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u043E, \u0441\u0430\u043C \u043E\u0442\u0437\u044B\u0432?!"},reviewsCheckbox:{required:"\u0427\u0442\u043E\u0431\u044B \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0442\u0437\u044B\u0432, \u043D\u0443\u0436\u043D\u043E \u043F\u0440\u0438\u043D\u044F\u0442\u044C \u043F\u043E\u043B\u0438\u0442\u0438\u043A\u0443 \u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438!"},botQuestion1:{required:"\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435!",minlength:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0432\u043E\u0434\u0430!",maxlength:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0432\u043E\u0434\u0430!"},botQuestion2:{required:"\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435!",minlength:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0432\u043E\u0434\u0430!",maxlength:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0432\u043E\u0434\u0430!"}},submitHandler:function(){let a=document.forms.sendForm,b=new FormData(a),d=new XMLHttpRequest;return d.open("POST","php/send.php"),d.onreadystatechange=function(){4==d.readyState&&200==d.status&&($(".reviews-page__form").slideUp(800),c())},d.send(b),!1}})});